/*
========================================================================================
    Module-Specific Configuration
========================================================================================
    Resource requirements for specific processes
*/

process {
    // FastQC processes
    withName: FASTQC_RAW {
        cpus = 2
        memory = '4.GB'
    }

    withName: FASTQC_TRIMMED {
        cpus = 2
        memory = '4.GB'
    }

    // Trimming
    withName: FASTP {
        cpus = { check_max( 4, 'cpus' ) }
        memory = { check_max( 8.GB * task.attempt, 'memory' ) }
    }

    // BWA alignment
    withName: BWA_INDEX {
        cpus = 1
        memory = '8.GB'
    }

    withName: BWA_MEM {
        cpus = { check_max( 8, 'cpus' ) }
        memory = { check_max( 16.GB * task.attempt, 'memory' ) }
        time = { check_max( 8.h * task.attempt, 'time' ) }
    }

    // SAMtools processes
    withName: SORT_BAM {
        cpus = { check_max( 4, 'cpus' ) }
        memory = { check_max( 8.GB * task.attempt, 'memory' ) }
    }

    withName: ALIGNMENT_STATS {
        cpus = 2
        memory = '4.GB'
    }

    // MultiQC
    withName: MULTIQC {
        cpus = 1
        memory = '4.GB'
    }
}
