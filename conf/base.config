/*
========================================================================================
    Base Process Configuration
========================================================================================
    Default resource requirements and error handling for all processes
*/

process {
    // Error handling
    errorStrategy = { task.exitStatus in [143,137,104,134,139] ? 'retry' : 'finish' }
    maxRetries = 2

    // Default container
    container = null

    // Resource labels - processes can use these labels for standardized resources
    withLabel: process_low {
        cpus = { check_max( 2, 'cpus' ) }
        memory = { check_max( 4.GB * task.attempt, 'memory' ) }
        time = { check_max( 2.h * task.attempt, 'time' ) }
    }

    withLabel: process_medium {
        cpus = { check_max( 4, 'cpus' ) }
        memory = { check_max( 8.GB * task.attempt, 'memory' ) }
        time = { check_max( 4.h * task.attempt, 'time' ) }
    }

    withLabel: process_high {
        cpus = { check_max( 8, 'cpus' ) }
        memory = { check_max( 16.GB * task.attempt, 'memory' ) }
        time = { check_max( 8.h * task.attempt, 'time' ) }
    }
}
